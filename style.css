:root{
  --bg:#0f1226; --panel:#151a36; --text:#E7E9FF; --muted:#9aa3b2;
  --accent:#6C8CFF; --accent2:#23D0A8; --danger:#FF6B6B; --shadow:0 10px 30px rgba(0,0,0,.35)
}
*{box-sizing:border-box}
body{margin:0;background:var(--bg);color:var(--text);font:16px/1.45 "Segoe UI",system-ui,-apple-system,Arial}
#app{max-width:1100px;margin:0 auto;padding:16px;position:relative;z-index:10} /* ↑ keep app above canvases */

/* Background canvases (never intercept clicks) */
#space-bg{
  position: fixed; inset: 0; z-index: 0;
  background: radial-gradient(ellipse at 50% 120%, #0a0d20 0%, #07091a 50%, #050716 100%);
  pointer-events: none;
}
#confetti{
  position: fixed; inset: 0; z-index: 1; pointer-events: none; /* lowered below UI */
}

.topbar{
  display:flex;justify-content:space-between;align-items:center;
  padding:14px 18px;background:var(--panel);border-radius:12px;
  box-shadow:0 10px 30px rgba(0,0,0,.35), 0 0 24px rgba(108,140,255,.08);
  position:relative; z-index:11; /* ↑ above canvases and card aurora */
}
.topbar.pulse{ animation: neon 0.4s ease; }
@keyframes neon{
  0%{box-shadow:0 10px 30px rgba(0,0,0,.35),0 0 0 rgba(108,140,255,0)}
  50%{box-shadow:0 10px 30px rgba(0,0,0,.35),0 0 16px rgba(108,140,255,.7)}
  100%{box-shadow:0 10px 30px rgba(0,0,0,.35),0 0 0 rgba(108,140,255,0)}
}
.topbar h1{margin:0;font-size:20px;font-weight:800}
#score{color:var(--accent2);font-weight:700}

.card{
  margin-top:16px;padding:32px;background:var(--panel);
  border-radius:20px;box-shadow:var(--shadow);
  min-height:70vh;display:flex;flex-direction:column;justify-content:flex-start;
  position:relative;overflow:hidden; z-index:10; /* keep above canvases */
}
/* Aurora glow behind the card */
.card::before{
  content:""; position:absolute; inset:-20%;
  background: radial-gradient(600px 300px at 30% 20%, rgba(108,140,255,.18), transparent 60%),
              radial-gradient(500px 260px at 70% 80%, rgba(35,208,168,.14), transparent 60%);
  filter: blur(20px);
  z-index:0;
}
.card > *{ position:relative; z-index:1; }

h2{margin:.2em 0 .6em}
p{color:var(--muted);margin:.2em 0 1em}

/* Buttons (always clickable and above nearby effects) */
.btn{
  appearance:none;border:0;border-radius:12px;padding:12px 16px;
  font-weight:700;cursor:pointer;color:var(--text);background:#20264d;
  transition:.2s;box-shadow:0 4px 16px rgba(0,0,0,.25);
  position:relative; z-index:12; pointer-events:auto;
}
.btn:hover{background:#2a3170}
.btn.accent{background:var(--accent)}
.btn.accent:hover{filter:brightness(1.1)}
.btn.ghost{background:transparent;border:1px solid #2a3170}
.btn.choice{width:100%;text-align:left;margin:.4rem 0;padding:14px 16px;border:1px solid #26305f;background:#1b2044}
.btn.choice:hover{border-color:var(--accent); box-shadow:0 0 14px rgba(108,140,255,.35); transform:translateY(-1px)}
.btn.choice.locked{ animation: lockPulse .35s ease; }
@keyframes lockPulse{
  0%{transform:scale(1)}
  40%{transform:scale(1.02)}
  100%{transform:scale(1)}
}

.q-meta{display:flex;justify-content:space-between;color:var(--muted);font-size:13px}
.q-title{font-size:24px;font-weight:800;margin:10px 0 16px}

/* Glitch title */
.q-title.glitch{ position: relative; display:inline-block; }
.q-title.glitch::before,
.q-title.glitch::after{
  content: attr(data-text);
  position: absolute; left: 0; top: 0; width: 100%;
  overflow: hidden; mix-blend-mode: screen; opacity: .6; pointer-events: none;
}
.q-title.glitch::before{ color:#6C8CFF; transform: translate(1px, 0); clip-path: polygon(0 2%,100% 2%,100% 38%,0 38%); }
.q-title.glitch::after { color:#FF6B6B; transform: translate(-1px, 0); clip-path: polygon(0 62%,100% 62%,100% 98%,0 98%); }
.q-title.glitch:hover{ animation: glitch-wobble 900ms infinite; }
@keyframes glitch-wobble{
  0%{transform:translate(0,0)}20%{transform:translate(.6px,-.6px)}
  40%{transform:translate(-.6px,.6px)}60%{transform:translate(.6px,.6px)}
  80%{transform:translate(-.6px,-.6px)}100%{transform:translate(0,0)}
}

/* Equal-height grid */
.grid{display:grid;gap:16px;align-items:stretch}
.grid.cols-2{grid-template-columns:repeat(2,1fr)}
.grid.cols-3{grid-template-columns:repeat(3,1fr)}

/* Option card */
.option{
  background:#1b2044;border:1px solid #26305f;border-radius:16px;
  padding:18px;display:flex;flex-direction:column;box-shadow:var(--shadow);
  position:relative; z-index:10;
}
.option.locked{ animation: lockPulse .35s ease; }

/* Floaty zero-gravity effect */
.floaty{ animation: floaty 5.5s ease-in-out infinite; }
@keyframes floaty{
  0%,100%{ transform: translateY(0) }
  50%    { transform: translateY(-6px) }
}

/* Image viewing window (no crop/zoom) */
.imgbox{
  flex:1 1 340px;min-height:320px;display:flex;align-items:center;justify-content:center;
  background:#151a36;border-radius:12px; transition: box-shadow .2s ease;
}
.imgbox:hover{ box-shadow:0 0 18px rgba(108,140,255,.25); }
.imgbox img{ max-width:100%;max-height:100%;object-fit:contain;display:block;border-radius:10px }

/* Pick buttons aligned at bottom */
.btn.pick{
  margin-top:auto;width:100%;min-height:44px;text-align:left;padding-left:16px;
  border:1px solid #2a3170;background:#1b2148
}
.btn.pick:hover{border-color:var(--accent); box-shadow:0 0 14px rgba(108,140,255,.35); transform:translateY(-1px)}
.btn.pick.locked{ animation: lockPulse .35s ease; }

/* Streak */
.streak{ margin-top:8px; color:var(--accent2); font-weight:700 }

/* Feedback message */
.feedback{padding:10px 14px;border-radius:10px;margin:12px 0;font-weight:700}
.feedback.ok{background:rgba(35,208,168,.15);color:var(--accent2)}
.feedback.bad{background:rgba(255,107,107,.15);color:var(--danger)}

/* Progress */
.footer{margin-top:14px}
#progress{height:10px;background:#23284f;border-radius:999px;overflow:hidden}
#bar{height:100%;width:0;background: linear-gradient(90deg, var(--accent), var(--accent2)); background-size:200% 100%; transition:width .25s}
#bar.pulse{ animation: neonBar 0.4s ease }
@keyframes neonBar{
  0%{filter:brightness(1)}
  50%{filter:brightness(1.5)}
  100%{filter:brightness(1)}
}

/* Key takeaways + leaderboard */
.keybox{margin-top:24px;padding:18px;border:1px solid #26305f;background:#1b2044;border-radius:12px}
.keybox h3{margin-top:0}
.small{font-size:13px;color:var(--muted)}
.board{margin:.2em 0 0 1em}
.board li{margin:.2em 0}
.board em{color:var(--muted);font-style:normal;margin-left:.5em}

/* Emoji pop */
#emoji-pop{
  position: fixed; left: 50%; top: 25%; transform: translate(-50%,-50%) scale(.9);
  font-size: 64px; z-index: 20; opacity: 0; transition: transform .15s, opacity .15s; pointer-events:none;
}
#emoji-pop.show{ opacity:1; transform: translate(-50%,-50%) scale(1.05) }

/* Glitch overlay */
#glitch{
  position: fixed; inset: 0; z-index: 3; pointer-events: none; opacity: 0;
  background: repeating-linear-gradient(0deg, rgba(255,255,255,.03), rgba(255,255,255,.03) 2px, transparent 2px, transparent 4px);
  mix-blend-mode: screen;
  transition: opacity .1s;
}
#glitch.show{ opacity: 1; animation: glitchFlash .6s ease }
@keyframes glitchFlash{
  0%{ opacity: 0 }
  10%{ opacity: .7 }
  100%{ opacity: 0 }
}

/* Signature footer (optional) */
.signature{
  text-align:center;margin-top:24px;padding:14px;font-size:14px;color:var(--muted);opacity:.8
}

/* Responsive */
@media (max-width:800px){
  .grid.cols-2,.grid.cols-3{grid-template-columns:1fr}
  .imgbox{min-height:240px}
}

/* ===== Highlighting after answer ===== */
/* For image options */
.option.selected-correct { border-color: var(--accent2); box-shadow: 0 0 18px rgba(35,208,168,.35); }
.option.selected-wrong   { border-color: var(--danger);  box-shadow: 0 0 18px rgba(255,107,107,.35); }
.option.correct          { outline: 2px solid var(--accent2); outline-offset: 3px; }

/* For text buttons */
.btn.choice.selected-correct { border-color: var(--accent2); box-shadow: 0 0 14px rgba(35,208,168,.35); }
.btn.choice.selected-wrong   { border-color: var(--danger);  box-shadow: 0 0 14px rgba(255,107,107,.35); }
.btn.choice.correct          { outline: 2px solid var(--accent2); outline-offset: 2px; }

/* Dim non-selected items a bit, and prevent more clicks */
.option.disabled, .btn.choice.disabled { opacity: .6; pointer-events: none; }

/* ===== Leaderboard modal ===== */
#lb-modal {
  position: fixed;
  inset: 0;
  display: none;
  align-items: center;
  justify-content: center;
  z-index: 2000; /* on top of everything */
}
#lb-modal.show { display: flex; }

.lb-backdrop {
  position: absolute;
  inset: 0;
  background: rgba(0,0,0,0.65);
}

.lb-panel {
  position: relative;
  background: #1b1f2a;
  color: #f5f5f5;
  border-radius: 12px;
  padding: 20px;
  width: 90%;
  max-width: 420px;
  box-shadow: 0 8px 24px rgba(0,0,0,0.5);
  animation: popIn 0.3s ease;
  z-index: 1001;
}

.lb-head {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 12px;
}

.lb-panel h3 {
  margin: 0;
  font-size: 20px;
}

.lb-board {
  padding-left: 20px;
  margin: 0 0 12px 0;
}

.lb-board li {
  margin: 4px 0;
  display: flex;
  justify-content: space-between;
}

@keyframes popIn {
  from { transform: scale(0.9); opacity: 0; }
  to { transform: scale(1); opacity: 1; }
}
